{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/basti/Documents/MyDigitalSchool/React/MDS-B3-2023-Food-Delivery/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/basti/Documents/MyDigitalSchool/React/MDS-B3-2023-Food-Delivery/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import axios from'axios';import{toast}from'react-toastify';var api=axios.create({baseURL:process.env.REACT_APP_API_URL,headers:{'Content-Type':'application/json',Accept:'application/json'},timeout:10000});api.interceptors.request.use(function(config){var authState=window.localStorage.getItem('AUTH');var auth=JSON.parse(authState);if(auth.user&&auth.token){config.headers.Authorization=\"Bearer \".concat(auth.token);}return config;},function(error){return Promise.reject(error);});var getRestaurants=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return api.get('/restaurants?populate=*');case 3:response=_context.sent;return _context.abrupt(\"return\",response.data);case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function getRestaurants(){return _ref.apply(this,arguments);};}();var getRestaurantById=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(id){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return api.get(\"/restaurants/\".concat(id,\"?populate=*\"));case 3:response=_context2.sent;return _context2.abrupt(\"return\",response.data);case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);case 10:case\"end\":return _context2.stop();}},_callee2,null,[[0,7]]);}));return function getRestaurantById(_x){return _ref2.apply(this,arguments);};}();var getDishesByRestaurantId=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(id){var response;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return api.get(\"/dishes?filters[restaurant][id][$eq]=\".concat(id,\"&populate=*\"));case 3:response=_context3.sent;return _context3.abrupt(\"return\",response.data);case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);console.error(_context3.t0);case 10:case\"end\":return _context3.stop();}},_callee3,null,[[0,7]]);}));return function getDishesByRestaurantId(_x2){return _ref3.apply(this,arguments);};}();var createRestaurant=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(formData){var _data,response;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_data={data:{// Spécifique à Strapi\nname:formData.name,description:formData.description,coordinates:{latitude:formData.latitude,longitude:formData.longitude}}};_context4.next=4;return api.post('/restaurants',_data);case 4:response=_context4.sent;return _context4.abrupt(\"return\",response.data);case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](0);console.error(_context4.t0);case 11:case\"end\":return _context4.stop();}},_callee4,null,[[0,8]]);}));return function createRestaurant(_x3){return _ref4.apply(this,arguments);};}();var login=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(credential){var response;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_context5.next=2;return api.post('auth/local',credential);case 2:response=_context5.sent;return _context5.abrupt(\"return\",response.data);case 4:case\"end\":return _context5.stop();}},_callee5);}));return function login(_x4){return _ref5.apply(this,arguments);};}();var register=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(credential){var response;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:_context6.next=2;return api.post('auth/local/register',credential);case 2:response=_context6.sent;return _context6.abrupt(\"return\",response.data);case 4:case\"end\":return _context6.stop();}},_callee6);}));return function register(_x5){return _ref6.apply(this,arguments);};}();export{getRestaurants,getRestaurantById,getDishesByRestaurantId,createRestaurant,login,register};","map":{"version":3,"names":["axios","toast","api","create","baseURL","process","env","REACT_APP_API_URL","headers","Accept","timeout","interceptors","request","use","config","authState","window","localStorage","getItem","auth","JSON","parse","user","token","Authorization","error","Promise","reject","getRestaurants","get","response","data","console","getRestaurantById","id","getDishesByRestaurantId","createRestaurant","formData","_data","name","description","coordinates","latitude","longitude","post","login","credential","register"],"sources":["C:/Users/basti/Documents/MyDigitalSchool/React/MDS-B3-2023-Food-Delivery/frontend/src/services/Api.js"],"sourcesContent":["import axios from 'axios'\r\nimport { toast } from 'react-toastify'\r\n\r\nconst api = axios.create({\r\n  baseURL: process.env.REACT_APP_API_URL,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n    Accept: 'application/json'\r\n  },\r\n  timeout: 10000\r\n})\r\n\r\napi.interceptors.request.use(\r\n  config => {\r\n    const authState = window.localStorage.getItem('AUTH')\r\n    const auth = JSON.parse(authState)\r\n    if (auth.user && auth.token) {\r\n      config.headers.Authorization = `Bearer ${auth.token}`\r\n    }\r\n    return config\r\n  },\r\n  error => {\r\n    return Promise.reject(error)\r\n  }\r\n)\r\n\r\nconst getRestaurants = async () => {\r\n  try {\r\n    const response = await api.get('/restaurants?populate=*')\r\n    return response.data\r\n  } catch (error) {\r\n    console.error(error)\r\n  }\r\n}\r\n\r\nconst getRestaurantById = async (id) => {\r\n  try {\r\n    const response = await api.get(`/restaurants/${id}?populate=*`)\r\n    return response.data\r\n  } catch (error) {\r\n    console.error(error)\r\n  }\r\n}\r\n\r\nconst getDishesByRestaurantId = async (id) => {\r\n  try {\r\n    const response = await api.get(`/dishes?filters[restaurant][id][$eq]=${id}&populate=*`)\r\n    return response.data\r\n  } catch (error) {\r\n    console.error(error)\r\n  }\r\n}\r\n\r\nconst createRestaurant = async (formData) => {\r\n  try {\r\n    const _data = {\r\n      data: { // Spécifique à Strapi\r\n        name: formData.name,\r\n        description: formData.description,\r\n        coordinates: {\r\n          latitude: formData.latitude,\r\n          longitude: formData.longitude\r\n        }\r\n      }\r\n    }\r\n    const response = await api.post('/restaurants', _data)\r\n    return response.data\r\n  } catch (error) {\r\n    console.error(error)\r\n  }\r\n}\r\nconst login = async (credential) => {\r\n  const response = await api.post('auth/local', credential)\r\n  return response.data\r\n}\r\n\r\nconst register = async (credential) => {\r\n  const response = await api.post('auth/local/register', credential)\r\n  return response.data\r\n}\r\n\r\nexport {\r\n  getRestaurants,\r\n  getRestaurantById,\r\n  getDishesByRestaurantId,\r\n  createRestaurant,\r\n  login,\r\n  register\r\n}\r\n"],"mappings":"saAAA,MAAOA,MAAK,KAAM,OAAO,CACzB,OAASC,KAAK,KAAQ,gBAAgB,CAEtC,GAAMC,IAAG,CAAGF,KAAK,CAACG,MAAM,CAAC,CACvBC,OAAO,CAAEC,OAAO,CAACC,GAAG,CAACC,iBAAiB,CACtCC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClCC,MAAM,CAAE,kBACV,CAAC,CACDC,OAAO,CAAE,KACX,CAAC,CAAC,CAEFR,GAAG,CAACS,YAAY,CAACC,OAAO,CAACC,GAAG,CAC1B,SAAAC,MAAM,CAAI,CACR,GAAMC,UAAS,CAAGC,MAAM,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CACrD,GAAMC,KAAI,CAAGC,IAAI,CAACC,KAAK,CAACN,SAAS,CAAC,CAClC,GAAII,IAAI,CAACG,IAAI,EAAIH,IAAI,CAACI,KAAK,CAAE,CAC3BT,MAAM,CAACN,OAAO,CAACgB,aAAa,kBAAaL,IAAI,CAACI,KAAK,CAAE,CACvD,CACA,MAAOT,OAAM,CACf,CAAC,CACD,SAAAW,KAAK,CAAI,CACP,MAAOC,QAAO,CAACC,MAAM,CAACF,KAAK,CAAC,CAC9B,CAAC,CACF,CAED,GAAMG,eAAc,4FAAG,uLAEI1B,IAAG,CAAC2B,GAAG,CAAC,yBAAyB,CAAC,QAAnDC,QAAQ,+CACPA,QAAQ,CAACC,IAAI,0DAEpBC,OAAO,CAACP,KAAK,aAAO,oEAEvB,kBAPKG,eAAc,0CAOnB,CAED,GAAMK,kBAAiB,6FAAG,kBAAOC,EAAE,4KAERhC,IAAG,CAAC2B,GAAG,wBAAiBK,EAAE,gBAAc,QAAzDJ,QAAQ,iDACPA,QAAQ,CAACC,IAAI,6DAEpBC,OAAO,CAACP,KAAK,cAAO,sEAEvB,kBAPKQ,kBAAiB,6CAOtB,CAED,GAAME,wBAAuB,6FAAG,kBAAOD,EAAE,4KAEdhC,IAAG,CAAC2B,GAAG,gDAAyCK,EAAE,gBAAc,QAAjFJ,QAAQ,iDACPA,QAAQ,CAACC,IAAI,6DAEpBC,OAAO,CAACP,KAAK,cAAO,sEAEvB,kBAPKU,wBAAuB,8CAO5B,CAED,GAAMC,iBAAgB,6FAAG,kBAAOC,QAAQ,2JAE9BC,KAAK,CAAG,CACZP,IAAI,CAAE,CAAE;AACNQ,IAAI,CAAEF,QAAQ,CAACE,IAAI,CACnBC,WAAW,CAAEH,QAAQ,CAACG,WAAW,CACjCC,WAAW,CAAE,CACXC,QAAQ,CAAEL,QAAQ,CAACK,QAAQ,CAC3BC,SAAS,CAAEN,QAAQ,CAACM,SACtB,CACF,CACF,CAAC,wBACsBzC,IAAG,CAAC0C,IAAI,CAAC,cAAc,CAAEN,KAAK,CAAC,QAAhDR,QAAQ,iDACPA,QAAQ,CAACC,IAAI,6DAEpBC,OAAO,CAACP,KAAK,cAAO,sEAEvB,kBAjBKW,iBAAgB,8CAiBrB,CACD,GAAMS,MAAK,6FAAG,kBAAOC,UAAU,2JACN5C,IAAG,CAAC0C,IAAI,CAAC,YAAY,CAAEE,UAAU,CAAC,QAAnDhB,QAAQ,iDACPA,QAAQ,CAACC,IAAI,yDACrB,kBAHKc,MAAK,8CAGV,CAED,GAAME,SAAQ,6FAAG,kBAAOD,UAAU,2JACT5C,IAAG,CAAC0C,IAAI,CAAC,qBAAqB,CAAEE,UAAU,CAAC,QAA5DhB,QAAQ,iDACPA,QAAQ,CAACC,IAAI,yDACrB,kBAHKgB,SAAQ,8CAGb,CAED,OACEnB,cAAc,CACdK,iBAAiB,CACjBE,uBAAuB,CACvBC,gBAAgB,CAChBS,KAAK,CACLE,QAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}